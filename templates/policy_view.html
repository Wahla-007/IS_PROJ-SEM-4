{% extends "base.html" %}

{% block title %}{{ policy.website_name }} - Privacy Policy{% endblock %}

{% block content %}
<div class="policy-view-container">
    <div class="policy-actions-bar">
        <div class="policy-info">
            <h2>{{ policy.website_name }} Privacy Policy</h2>
            <div class="compliance-badges">
                {% if policy.gdpr_compliant %}
                    <span class="badge compliant">GDPR Compliant</span>
                {% else %}
                    <span class="badge non-compliant">GDPR Issues</span>
                {% endif %}
                
                {% if policy.ccpa_compliant %}
                    <span class="badge compliant">CCPA Compliant</span>
                {% else %}
                    <span class="badge non-compliant">CCPA Issues</span>
                {% endif %}
            </div>
        </div>
        
        <div class="policy-vulnerability">
            <label>Website Health Score:</label>
            <div class="score-bar">
                <div class="score-fill" style="width: {{ policy.vulnerability_score }}%;" 
                     data-score="{{ policy.vulnerability_score }}"></div>
            </div>
            <span class="score-value">{{ policy.vulnerability_score }}%</span>
        </div>
        
        <div class="action-buttons">
            <a href="{{ url_for('download_policy', policy_id=policy._id) }}" class="btn btn-primary">Download</a>
            <a href="{{ url_for('dashboard') }}" class="btn btn-outline">Back to Dashboard</a>
        </div>
    </div>
    
    <div class="policy-content-wrapper">
        <div class="policy-content">
            <pre>{{ policy.policy_text }}</pre>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_scripts %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        const scoreFill = document.querySelector('.score-fill');
        const score = parseInt(scoreFill.getAttribute('data-score'));
        
        if (score < 40) {
            scoreFill.classList.add('score-low');
        } else if (score < 70) {
            scoreFill.classList.add('score-medium');
        } else {
            scoreFill.classList.add('score-high');
        }
    });
</script>
{% endblock %}